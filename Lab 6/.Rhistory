setwd("C:/Users/domin/Downloads")
setwd("C:/Users/edna")
setwd("C:/Users/domin/OneDrive/edna")
install.packages("seqinr", dependencies = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
BiocManager::install("Biostrings")
BiocManager::install("pwalign")
refs <- read.fasta("reference_sequences.fasta", as.string = TRUE)
setwd("C:/Users/domin/Downloads")
setwd("~/Desktop/R course")
remove.packages(c("Biostrings","msa", "rentrez"))
setwd("~/Desktop/R course")
install.packages(c("Biostrings", "msa", "rentrez"))
install.packages(c("Biostrings", "msa", repos=null))
remove.packages(c("Biostrings", "msa", "rentrez"))
remove.packages(c("Biostrings", "msa", "rentrez"))
setwd(~/Dominic-Personal/R course)
setwd(Dominic-Personal/R course)
setwd(Dominic - Personal/R course)
setwd("~/Desktop/R course")
setwd("Dominic - Personal/Desktop/ R course")
setwd("One Drive/Desktop/R Course")
install.packages(c("Biostrings", "msa", "rentrez"))
(!requireNamespace("BiocManager", quietly = TRUE)
install.packages("BiocManager", force=TRUE)
#####################
# load libraries
####################
library(Biostrings)
library(rentrez)
library(msa)
BiocManager::install(c("Biostrings", "msa")) #in English: Uses BiocManager to install Biostrings and msa
setwd("OneDrive/Dominic - Personal/Desktop/R course")
#######################
## Step 5: Align your cleaned sequences using MUSCLE, Progressive method
# MUSCLE builds an alignment by progressively aligning sequences, then repeatedly refining it to improve accuracy, this is the default method in most pipeline
#######################
aln <- msa(dna.clean, method = "Muscle")
class(aln)
aln
#######################
## Step 6: Make a tree
#######################
aligned <- as.DNAbin(aln)  #makes the seuqences useful for downstream analyses
aligned
d <- dist.dna(aligned, model = "K80")
#######################
# Food for thought
#######################
#Building a tree based on pure similarity, can you figure out what the tree will look like just by using the distance matrix values?
d
hc <- hclust(as.dist(d), method = "average")   # UPGMA-style clustering, UPGMA build a tree by repeatedly grouping together the most similar sequences, step-by-step.
tree <- as.phylo(hc) #forces the heuristic clustering into a phylogeny
# Install Biostrings from Bioconductor
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
'force = TRUE'
library(Biostrings)
install.packages("pwalign")
library(pwalign)
# Step 1: Install and load Biostrings
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("Biostrings")
# Step 4: View alignment
alignment
# Step 5: Calculate percent identity
alignment_width <- width(alignment)             # total alignment length
identical_bases <- nmatch(alignment)           # number of matches
percent_identity <- (identical_bases / alignment_width) * 100
# Step 1: Install and load Biostrings
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("Biostrings")
# Step 2: Define the sequences
# Query sequence (original mRNA converted to amino acids or DNA for alignment)
query_seq <- DNAString(
"CTCGAGACTAGTTCTCTCTCTCTCTCTCTCGTGCCGCATCTCACACCTGTGGATGGACGGCAGCTGAACCGCGGGAAACTTTCGTTCTCACTCTACCTAGATGAACTTTAGTTTATATTAAACACGCGTCGACTCCCACACAAACCGTGCTCGTTTTACATCTTTGTCTCCGCTTTTGAAAACGAGAAGTTGAATTCGCAAGACGCAACTTTCCAGCCCCTCACTGAGCGGGCAGAGTCCGTGAAGCGATGGAGCCGTCCGTCATTCCCGGTGCTGACATACCCGACCTTTACTCCATTAACCCGTTTAATGTCACTTTTCCCGACGACGTTTTGAGTTTCGTTCCTGATGGGAGGAACTACACCGAACCTAACCCGGTAAAGAGCCGCGGAATCATCATCGCCATTTCCATCACCGCTC"
)
# Subject sequence (second sequence)
subject_seq <- DNAString(
"CTCGAGACTAGTTCTCTCTCTCTCTCTCTCGTGCCGCATCTCACACCTGTGGATGGACGGCAGCTGAACCGCGGGAAACTTTCGTTCTCACTCTACCTAGATGAACTTTAGTTTATATTAAACACGCGTCGACTCCCACACAAACCGTGCTCGTTTTACATCTTTGTCTCCGCTTTTGAAAACGAGAAGTTGAATTCGCAAGACGCAACTTTCCAGCCCCTCACTGAGCGGGCAGAGTCCGTGAAGCGATGGAGCCGTCCGTCATTCCCGGTGCTGACATACCCGACCTTTACTCCATTAACCCGTTTAATGTCACTTTTCCCGACGACGTTTTGAGTTTCGTTCCTGATGGGAGGAACTACACCGAACCTAACCCGGTAAAGAGCCGCGGAATCATCATCGCCATTTCCATCACCGCTCTTTACTCCGTTATCTGCGTTGTGGGACTCTTAGGAAACATCCTAGTGATGTACGGGGTGGTCAGATACACCAAGCTGAAAACTGCCACCAACATCTACATCTTCAATTTGGCCCTGGCAGATGCACTGGCTACTAGTACACTTCCATTCCAGAGCACCAAGTATTTAATGAACACCTGGCCCTTCGGTGAGCTCCTTTGCAAAGTGGTCATAGCCATAGACTACTACAATATGTTTACCAGTATCTTCACTCTCACTATGATGAGCGTGGACCGTTACATTGCTGTGTGCCACCCTGTGAGAGCACTGGAGTTTCGTACCCCGATCAAGGCCAAAATAATCAATGTGTGCATCTGGATCCTCTCCTCCGCTGTTGGAGTGCCAATCATGATTATGGCAGTCACTAGAGTGACAAATCAGAATACAACAGTCTGCATGCTGAAGTTCCCTGATCCAGACTGGTACTGGGACACAGTCACAAAGATCTGTGTGTTTATCTTTGCATTTGTGGTACCAGTCCTAGTCATAACAATCTGCTATGGTCTGATGATCCTACGCTTGAAAAGTGTCCGTCTTCTCTCAGGCTCAAAGGAGAAGGACAGAAACATGCGTCGAATCACTCGAATGGTTTTGGTTGTTGTGGCTGCCTTCATTATCTGCTGGACACCAATTCACATCTTCATCATTGAGAAAACACTGGT TGACATCAACCAAAAGAACCCCTTCGTGATTGCTAGCTGGCACTTGCATCGCACTGGTTATACCAACAGCAGCCTCAATCCTGTGCTTTATGCTTTCTTGGATGAGAATTTCAAGAGATGCTTCCGAGACTTTTGCCTACCATTCAGAACAAGGGCTGACCAGAGTAATCTGAACCGAGCAAGGAATGCCACAAGGGAGCCAGTTTCAGTTTGTGCCCTTCGGATACAGGAAAGAAGCCGGTATGACTAGGCCTGGACAGGATCCACGGGGGTCCCAATCTAGAAGAGTACAGCAGGACCTACAATCAGAGGTCACCCAAATCTCCACTACTGAATTC"
)
# Step 3: Perform global pairwise alignment
alignment <- pairwiseAlignment(query_seq, subject_seq, type="global")
# Subject sequence (second sequence)
subject_seq <- DNAString(
"CTCGAGACTAGTTCTCTCTCTCTCTCTCTCGTGCCGCATCTCACACCTGTGGATGGACGGCAGCTGAACCGCGGGAAACTTTCGTTCTCACTCTACCTAGATGAACTTTAGTTTATATTAAACACGCGTCGACTCCCACACAAACCGTGCTCGTTTTACATCTTTGTCTCCGCTTTTGAAAACGAGAAGTTGAATTCGCAAGACGCAACTTTCCAGCCCCTCACTGAGCGGGCAGAGTCCGTGAAGCGATGGAGCCGTCCGTCATTCCCGGTGCTGACATACCCGACCTTTACTCCATTAACCCGTTTAATGTCACTTTTCCCGACGACGTTTTGAGTTTCGTTCCTGATGGGAGGAACTACACCGAACCTAACCCGGTAAAGAGCCGCGGAATCATCATCGCCATTTCCATCACCGCTCTTTACTCCGTTATCTGCGTTGTGGGACTCTTAGGAAACATCCTAGTGATGTACGGGGTGGTCAGATACACCAAGCTGAAAACTGCCACCAACATCTACATCTTCAATTTGGCCCTGGCAGATGCACTGGCTACTAGTACACTTCCATTCCAGAGCACCAAGTATTTAATGAACACCTGGCCCTTCGGTGAGCTCCTTTGCAAAGTGGTCATAGCCATAGACTACTACAATATGTTTACCAGTATCTTCACTCTCACTATGATGAGCGTGGACCGTTACATTGCTGTGTGCCACCCTGTGAGAGCACTGGAGTTTCGTACCCCGATCAAGGCCAAAATAATCAATGTGTGCATCTGGATCCTCTCCTCCGCTGTTGGAGTGCCAATCATGATTATGGCAGTCACTAGAGTGACAAATCAGAATACAACAGTCTGCATGCTGAAGTTCCCTGATCCAGACTGGTACTGGGACACAGTCACAAAGATCTGTGTGTTTATCTTTGCATTTGTGGTACCAGTCCTAGTCATAACAATCTGCTATGGTCTGATGATCCTACGCTTGAAAAGTGTCCGTCTTCTCTCAGGCTCAAAGGAGAAGGACAGAAACATGCGTCGAATCACTCGAATGGTTTTGGTTGTTGTGGCTGCCTTCATTATCTGCTGGACACCAATTCACATCTTCATCATTGAGAAAACACTGGT TGACATCAACCAAAAGAACCCCTTCGTGATTGCTAGCTGGCACTTGCATCGCACTGGTTATACCAACAGCAGCCTCAATCCTGTGCTTTATGCTTTCTTGGATGAGAATTTCAAGAGATGCTTCCGAGACTTTTGCCTACCATTCAGAACAAGGGCTGACCAGAGTAATCTGAACCGAGCAAGGAATGCCACAAGGGAGCCAGTTTCAGTTTGTGCCCTTCGGATACAGGAAAGAAGCCGGTATGACTAGGCCTGGACAGGATCCACGGGGGTCCCAATCTAGAAGAGTACAGCAGGACCTACAATCAGAGGTCACCCAAATCTCCACTACTGAATTC"
)
# Step 4: View alignment
alignment
# Step 5: Calculate percent identity
alignment_width <- width(alignment)             # total alignment length
identical_bases <- nmatch(alignment)           # number of matches
percent_identity <- (identical_bases / alignment_width) * 100
cat("Percent identity between the two sequences:", round(percent_identity, 2), "%\n")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
library(Biostrings)
install.packages(“seqinr”)
install.packages(“seqinr”)
install.packages("seqinr")
library(Biostrings)
library(seqinr)
install.packages("BiocManager")
BiocManager::install("msa")
library(msa)
library(Biostrings)
seqs <- readDNAStringSet("Hs10.fasta")
getwd()
setwd(C:\Users\domin\OneDrive\Documents\GitHub\Bioinformatics\Lab 6)
setwd(C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6)
setwd "(C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6)"
setwd("C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6")
setwd "(C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6)"
setwd("C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6")
> setwd("C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6")
setwd("C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6")
setwd("C:/Users/domin/OneDrive/Documents/GitHub/Bioinformatics/Lab 6")
getwd
getwd()
seqs <- readDNAStringSet("Hs10.fasta")
seqs <- readDNAStringSet("Hs1.fasta")
View(seqs)
seqs <- readDNAStringSet("Hs1.fasta")
seqs <- readDNAStringSet("Hs128.fasta")
seqs <- readDNAStringSet("Hs7.fasta")
seqs <- readDNAStringSet("Hs104.fasta")
seq_1 <- readDNAStringSet("Hs10.fasta")
seq_2 <- readDNAStringSet("Hs1.fasta")
seq_3 <- readDNAStringSet("Hs128.fasta")
seqs_4 <- readDNAStringSet("Hs7.fasta")
seq_5 <- readDNAStringSet("Hs104.fasta")
sequences <- c(seq_1, seq_2, seq_3, seqs_4, seq_5)
sequences
alignment <- msa(sequences, method = "Muscle")
msaPrettyPrint(alignment)
msaPrettyPrint(alignment)
alignment
print(alignment, show="complete")
alignment_matrix <- as.matrix(alignment)
gc_counts <- apply(alignment_matrix, 1, function(seq) sum(seq == "G" | seq == "C"))
seq_length <- apply(alignment_matrix, 1, length)
gc_content <- gc_counts / seq_length * 100
gc_content
library(seqinr)
seqs_seqinr <- msaConvert(alignment, type = "seqinr::alignment")
dist_matrix <- dist.alignment(seqs_seqinr, "identity")  # percent identity
dist_matrix
as.matrix(dist_matrix)
library(Biostrings)
dna_seq <- sequences[[1]]
dna_seq
protein_seq <- translate(dna_seq)
protein_seq
dna_seq <- sequences[[1]]
protein_seq <- translate(dna_seq)
protein_seq
as.character(protein_seq)
install.packages("phangorn")
library(phangorn)
Alignment_phyDat <- msaConvert(alignment, type="phangorn::phyDat")
write.phyDat(Alignment_phyDat, file="alignment.fasta", format="fasta")
getwd()
list.files()
